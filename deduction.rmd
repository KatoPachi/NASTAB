---
title: |
  Deduction data
date: "Last updated on `r format(Sys.Date(), '%Y/%m/%d')`"
output:
  beamer_presentation:
    latex_engine: xelatex
    keep_tex: no
    toc: no
    dev: cairo_pdf
classoption: aspectratio=169
header-includes:
  - \usepackage{booktabs, threeparttable}
  - \usepackage{siunitx}
---

```{r include = FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  echo = FALSE,
  cache = FALSE,
  include = TRUE,
  fig.pos = "t",
  fig.width = 10,
  fig.height = 6
)

options(
  knitr.kable.NA = "",
  modelsummary_stars_note = FALSE,
  modelsummary_factory_default = "latex"
)

library(here)
source(here("R/R6_StartAnalysis.r"))
```

## Study Sample

```{r echo=TRUE}
use <- StartAnalysis$new(here("data/shaped2.csv"))
```

- Current sample size: `r nrow(use$data)`
  - Taxpayers
  - Positive taxable income
  - No experience of bracket (F) and (G)
  - $\text{Age}\ge 24$
  - Observed between 2010 and 2018
  - Exclude observations with no donation and declaration
  - donation less than 10% of taxable total income

## Summary Stats

```{r}
use_summary <- use$summary()
use_summary$stats(title = "Summary of Current Study Sample")
```

## Additional Condition

```{r echo=TRUE}
use2 <- use$clone(deep = TRUE)
use2$data <- subset(
  use2$data,
  family_position == 1 & work %in% c(1, 3)
)
```

- Sample size: `r nrow(use2$data)`
  - Household heads who are self-employed or full-time wage earners

## Summary Stats, Again

```{r}
use2_summary <- use2$summary()
use2_summary$stats(title = "Summary of New Study Sample")
```