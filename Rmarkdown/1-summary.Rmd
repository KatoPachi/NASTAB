
# Data

```{r library, include = FALSE}
library(xfun)
xfun::pkg_attach2(c("readstata13", "tidyverse", "rlist"))
xfun::pkg_attach2(c("plm", "lmtest", "sandwich"))
xfun::pkg_attach2("kableExtra")

lapply(Sys.glob(file.path("script/R/functions", "*.r")), source)

```
```{r ReadData, include =FALSE}
df <- readr::read_csv(
  "data/shaped2.csv",
  col_types = cols(
    ext_credit_giving = col_double(),
    krw_credit_giving = col_double(),
    trust_politician = col_double(),
    political_pref = col_double(),
    addtax = col_double(),
    avg_welfare_tax = col_double(),
    opt_welfare_tax = col_double(),
    now_balance = col_double(),
    ideal_balance = col_double()
  )
)
```

```{asis, echo = doctype == "slide"}
## National Survey of Tax and Benefit (NaSTaB)

- An annual financial panel survey implemented by The Korea Institute of Taxation and Finance implements to study the tax burden of households and the benefits that households receive from government.
- The subjects of this survey are general household and household members living in 15 cities and provinces nationwide.
- This survey is based on a face-to-face interview. If it is difficult for investigators to meet subjects, another family member answers on behalf of him.
- We use data from 2012 to 2018 **since the items of the value survey which we focused is not available before 2012 (ここは違いま???)**. In addition, we exclude the subject of the sample, whose age is under 23, since they are not likely to have income or asset.

## Summary Statistics

```

```{asis, echo = doctype == "draft"}
In this paper, we use panel data from the National Survey of Tax and Benefit (NasTaB). 
NasTaB survey is an annual financial panel survey 
implemented by The Korea Institute of Taxation and Finance 
to study the tax burden of households and the benefits that households receive from government. 
The subjects of this survey are general household and household members living in 15 cities 
and provinces nationwide. 
This survey is based on a face-to-face interview. 
If it is difficult for investigators to meet subjects, another family member answers on behalf of him. [^weight] 

[^weight]: Note that NasTaB data is constructed as the subjects represent the population of Korean society. This enables us to derive giving price elasticity of population without re-weighting samples, which is used in the extant research. Moreover, note that subjects are not limited to the tax payer or income earner reflecting the population.

In the analysis, we use data from 2013 to 2019 since 
we focus on the 2014 tax reform. 
By this restriction, the most giving price variation relies on the 2014 tax reform because
the marginal income tax rate is same in 2012 and 2013.
In addition, we exclude the subject of the sample, whose age is under 23, since they are not likely to have income or asset.

Table \@ref(tab:SummaryCovariate) is summary statistics of our sample. 
We used four types of variables in this paper: 
sets of variables about Income and Giving Price,
Charitable Donations, 
Government Efficiency, 
and Individual Characteristics. 
A set of variables about Government Efficiency is constructed from the value survey of NasTaB data.
Current Tax-Welfare Balance shows how the subject perceives the balance between tax burden and received welfare from the government, 
while Ideal Tax-Welfare Balance indicates what is the ideal balance between tax burden and received welfare for the subject. 
The higher values of them means that received welfare from the government is higher than tax burden. 
We explain the details and constructions of these variables later. 
The variables about Individual Characteristics, 
which consist from age, gender and final education levels, are used as control variables.

In the next two subsections,
we describe the first two set of variables in detail.
```

```{r SummaryCovariate}
x <- c(
  "i_total_giving", "i_ext_giving",
  "lincome", "price", "ext_benefit_tl",
  # "now_balance", "ideal_balance",
  "age", "gender", "employee",
  "univ", "highschool", "juniorhigh"
)

df %>%
  sumvars(x, stat = c("N", "mean", "sd", "min", "median", "max")) %>%
  mutate(
    vars = recode(
      vars,
      "lincome" = "Annual taxable income (unit: 10,000KRW)",
      "price" = "First giving price",
      "ext_benefit_tl" = "Dummy of tax report",
      "i_total_giving" = "Annual charitable giving (unit: 10,000KRW)",
      "i_ext_giving" = "Dummy of Donation > 0",
      "age" = "Age",
      "gender" = "Female dummy",
      "employee" = "Employee dummy",
      "univ" = "University graduate",
      "highschool" = "High school graduate dummy",
      "juniorhigh" = "Junior high school graduate dummy"
    )
  ) %>%
  kable(
    caption = "Descriptive Statistics",
    format = "latex",
    col.names = c("", "N", "Mean", "Std.Dev.", "Min", "Median", "Max"),
    align = "lcccccc", digits = 2,
    booktabs = TRUE, escape = TRUE, linesep = ""
  ) %>%
  kable_styling(font_size = 7) %>%
  pack_rows("Charitable Donations", 1, 2) %>%
  pack_rows("Income, giving price, and tax report", 3, 5) %>%
  pack_rows("Individual Characteristics", 6, 11)
```

## Charitable Giving

```{asis, echo = doctype == "draft"}
NaSTaB asks respondents to answer the amount of donation.[^Question] 
We use this variable as an first outcome variable when 
estimating the price effect on the amount of donations among donors (intensive margin).
Using this variable, we make a dummy variable taking 1 if repsondents donate (Dummy of Donation).
This is the second outcome variable 
to estimate the price effect on the decision of donations (extensive margin).

[^Question]:Respondents answer the amount of donation for seven specific purposes last year. Seven specific purposes are policitical parties, educational organizations, social welfare organizations, organizations for culutre and art, religious groups, charity activies organaized by religious group, other purposes.We sum up the amount of donations, and consider it as the annual charitable giving.

Table \@ref(tab:SummaryCovariate) shows that 
the average amount of donation is almost 300,000 KRW,
and the proportion of donors is roughly 20\%.
Figure \@ref(fig:SummaryOutcome) shows the time-series of two variables.
The blue line shows the average amount of donation among donors.
In each year, its value is nearly 1.5 million KRW,
which is 7\% of average annual taxable income.
The grey bar shows the proportion of donors.
After the tax reform, the proportion of donors decreases by 2\%.
After that, the proportion of donors is greter than 20\%.
```

```{r SummaryOutcome, out.width="90%", fig.cap="Proportion of Donors and Average Donations among Donors. Notes: The left and right axises respectively mesure proportion of donors and the average amount donations among donors. Authors made this graph based on NasTaB data."}
avgext <- df %>%
  group_by(year) %>%
  summarize_at(vars(i_ext_giving), list(mu = ~mean(., na.rm = TRUE)))

avgint <- df %>%
  filter(i_ext_giving == 1) %>%
  group_by(year) %>%
  summarize_at(vars(i_total_giving), list(mu = ~mean(., na.rm = TRUE)))

ggplot(avgext, aes(x = year, y = mu)) +
  geom_bar(aes(fill = "Extensive margin"), stat = "identity", color = "black") +
  geom_point(
    data = avgint, aes(x = year, y = mu / 1000, color = "Intensive margin"),
    size = 2
  ) +
  geom_line(
    data = avgint, aes(x = year, y = mu / 1000, color = "Intensive margin"),
    size = 1

  ) +
  geom_hline(aes(yintercept = 0)) +
  geom_vline(aes(xintercept = 2013.5), color = "red", linetype = 2, size = 1) +
  scale_fill_manual(NULL, values = "grey80") +
  scale_color_manual(NULL, values = "blue") +
  scale_y_continuous(sec.axis = sec_axis(
    ~. * 1000,
    name = "Average Amout of Donations among Donors (Intensive margin)"
  )) +
  scale_x_continuous(breaks = seq(2012, 2018, 1)) +
  labs(x = "Year", y = "Proportion of Donors (Extensive margin)") +
  ggtemp()
```

## Income and Giving Price

```{asis, echo = doctype == "slide"}
- Figure \@ref(fig:SummaryPriceChange) shows the giving price after 2012 and income distribution in 2013.
	- Blue line shows the giving price in 2012 and 2013, which depends on income
	- Red dashed line shows the giving price after 2014, which is not a function of income.
- We can make three groups in terms of the benefit from the 2014 tax reform.
	- Benefit group: Final taxable income is less than $1200 \times 10^4$KRW.
	- Neutral group: Final taxable income lies between $(1200 \times 10^4, 4600 \times 10^4)$.
	- Loss group: Final taxable income is more than $4600 \times 10^4$KRW.

## Giving Price and Income Distribution (Cont'd)
```

```{asis, echo = doctype == "draft"}
NaSTaB asks respondents to answer the annual income last year.
For example, in the 2014 survey, respondents answer the annual income at 2013.
In our sample, the average annual taxable income is 18.76 million KRW.
According to the National Tax Statistical Yearbook published by Korean National Tax Service,
the average annual taxable income is 32.77 million from 2012 to 2018
for employees who submited the tax return.
Since our sample includes subjects with no labor income, such as housewife,
our sample mean of income is lower than average income calculated by the public organizations.
In Figure \@ref(fig:SummaryPriceChange),
the grey bars show the distribution of annual taxable income in 2013.
The income distribution is left-skewed.

Using this variable, we construct the giving price under the tax deduction system (2012 and 2013).
After the tax reform (after 2014), the giving price is 0.85 under the tax credit system, 
as we explained in the section \@ref(institutional-background).
In Figure \@ref(fig:SummaryPriceChange),
the blue line shows giving price in 2012 and 2013,
while the red dashed line shows the giving price after 2014.
From this figure, 
those whose annual income is less than 1200 in 2013 could receive benefit by the 2014 tax reform
bacause the tax reform decreases the giving price.
On the other hand,
those whose auunal income is greater than 4600 in 2013 had a loss by the 2014 tax reform 
since the tax reform increases the giving price.
```

```{r SummaryPriceChange, out.width="90%", fig.cap="Income Distribution and Giving Price in 2013"}
df %>%
  filter(year == 2013) %>%
  dplyr::select(lincome, price) %>%
  ggplot(aes(x = lincome)) +
  geom_histogram(
    aes(y = ..count.. / sum(..count..), fill = "Relative frequency"),
    color = "black"
  ) +
  geom_step(
    aes(y = price * 0.5, color = "Giving Price in 2013"),
    size = 1
  ) +
  geom_hline(
    aes(yintercept = (1 - 0.15) * 0.5),
    color = "red", linetype = 2, size = 1
  ) +
  scale_color_manual(NULL, values = "blue") +
  scale_fill_manual(NULL, values = "grey80") +
  scale_y_continuous(
    breaks = seq(0, 0.5, 0.125),
    sec.axis = sec_axis(~ . / 0.5, name = "Giving price")
  ) +
  scale_x_continuous(breaks = c(1200, 4600, 8800, 30000)) +
  labs(x = "Annual taxable income (10,000KRW)", y = "Relative frequency") +
  ggtemp()
```

