
# Political Trust and Price Elasticity

## Estimation of Trust Index

The trust for politicans is time-varying variable because it depends on governments' policies.
We make time-invarying trust index using the fixed effect model.

$$
    \text{Trust}_{ijt} = \text{Trustid}_{ij} + c_j \cdot \lambda_t + \lambda_t + \epsilon_{ijt}.
$$

- $\text{Trust}_{ijt}$: trust for politicians (5-Likert scale)
- $\text{Trustid}_i$: individual fixed effect (**Trust index**)
- $c_j \cdot \lambda_t$ captures local governments' policies effect
- $\lambda_t$ captures the central government policies effect


```{stata EstimateTrustIndex, eval = FALSE}
xtreg trust_politician i.year##i.living_area if year >= 2015, fe
predict orgtrustid, u

xtreg trust_politician i.year##i.living_area if year == 2015 | year == 2016, fe
predict orgparktrustid, u

xtreg trust_politician i.year##i.living_area if year == 2017 | year == 2018, fe
predict orgmoontrustid, u



* make trustid dataset
frame copy default trustdt
frame trustdt: {
	bysort pid: egen trustid = mean(orgtrustid)
	bysort pid: egen parktrustid = mean(orgparktrustid) 
	bysort pid: egen moontrustid = mean(orgmoontrustid)
}
frame trustdt: keep pid trustid parktrustid moontrustid
frame trustdt: duplicates drop
frame trustdt: gen diff = moontrustid - parktrustid
frame trustdt: xtile original5 = trustid, nq(5) 
frame trustdt: xtile park5 = parktrustid, nq(5)
frame trustdt: {
	gen lessdiff1 = 0
	replace lessdiff1 = 1 if abs(diff) < 1
	replace lessdiff1 = . if missing(diff)
}
frame trustdt: {
	gen lessdiffhalf = 0
	replace lessdiffhalf = 1 if abs(diff) < 0.5
	replace lessdiffhalf = . if missing(diff)
}
frame trustdt: save "data\shape\trustid.dta", replace
```

## Histrogram of Trust Index

```{stata HistogramTrustid, results = "hide", eval = FALSE}
frame create trustdt
frame trustdt: use "data\shape\trustid.dta", clear

frame trustdt: {
	twoway ///
	(histogram trustid, freq yaxis(2) color(gs10%50) lcolor(black)), ///
	xtitle("Trust index") ///
	graphregion(fcolor(white))
	
	graph export "_assets/HistogramTrustid.pdf", replace
}
```

```{r, include = TRUE, out.width="90%", fig.cap="Histogram of Trust Index"}
knitr::include_graphics(paste(here(), "_assets/HistogramTrustid.pdf", sep= "/"))
```

## Relationship with Donations and Covariates 

- We made a scatter plot b/w individual average donations and trust index
    - No linear relationship
- We tested difference in mean of individual average donations b/w among those whose trust index above and below threshold
    - The difference in mean is statistically siginificant at 5\% level if threshold is $\{0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4\}$.
- We regressed trust index on covariates, using data in 2018
    - trust among females < trust among males
    - the positive correlation between income and trust index
    - trust index is concave in age
    - Those having extreme political views have a distrust of politicians rather than those having moderate political views.


## Relationship b/w Donations and Trust Index 

```{stata ScatterTrusidDonations, results = "hide", eval = FALSE}
merge m:1 pid using "data\shape\trustid.dta"
drop _merge

frame copy default scatdt
frame scatdt: bysort pid: egen avgdonate = mean(i_total_giving)
frame scatdt: keep pid trustid avgdonate
frame scatdt: duplicates drop

frame scatdt: {
	twoway  ///
	(scatter avgdonate trustid, color(gs10%50)),  ///
	xtitle("Trust index") ytitle("Individual average donations across time")  ///
	graphregion(fcolor(white))
	
	graph export "_assets/ScatterTrusidDonations.pdf", replace
}
```

```{r, include=TRUE, out.width="90%", fig.cap="Scatter Plot between Donations and Trust Index"}
knitr::include_graphics(paste(here(), "_assets/ScatterTrusidDonations.pdf", sep= "/"))
```

## Difference in Mean b/w Two Trust Groups

```{stata PlotDiffDonationsbwTrustGroup, results = "hide", eval = FALSE}
merge m:1 pid using "data\shape\trustid.dta"
drop _merge

frame copy default scatdt
frame scatdt: bysort pid: egen avgdonate = mean(i_total_giving)
frame scatdt: keep pid trustid avgdonate
frame scatdt: duplicates drop

frame create coefplotdt
frame coefplotdt: {
	set obs 21
	gen effect = .
	gen se_effect = .
	gen cutoff = .
}

frame scatdt: gen high = .
local k = 1
forvalues i = 0(.1)2.1 {
	di "k = `k'"
	frame scatdt: replace high = 0 if trustid <= `i'
	frame scatdt: replace high = 1 if trustid > `i'
	frame scatdt: replace high = . if missing(trustid)
	frame scatdt: reg avgdonate high 
	frame coefplotdt: replace effect = _b[high] if _n == `k'
	frame coefplotdt: replace se_effect = _se[high] if _n == `k'
	frame coefplotdt: replace cutoff = `i' if _n == `k'
	local k = `k' + 1
}

frame coefplotdt: gen lcoef = effect - 1.96*se_effect
frame coefplotdt: gen hcoef = effect + 1.96*se_effect

frame coefplotdt: {
	twoway ///
	(scatter effect cutoff, color(blue)) ///
	(line effect cutoff, color(blue))  ///
	(rcap hcoef lcoef cutoff, color(black)), ///
	yline(0, lcolor(red) lpattern(-))  ///
	xtitle("Threshold of trust index") ///
	ytitle("Difference in mean (+/- 1.96*se)") ///
	legend(off) ///
	graphregion(fcolor(white))

	graph export "_assets/PlotDiffDonationsbwTrustGroup.pdf", replace
}

```

```{r, include=TRUE, out.width="90%", fig.cap = "Difference in Mean between Trust Group above and below Threshold"}
knitr::include_graphics(paste(here(), "_assets/PlotDiffDonationsbwTrustGroup.pdf", sep= "/"))
```

## Regression of Trust Index on Covariates

```{stata RegTrustidOnCovariate, results = "hide", eval = FALSE}
merge m:1 pid using "data\shape\trustid.dta"
drop _merge

reg trustid gender log_pinc_all age sqage i.educ ib3.political_pref if year == 2018

mat coef = r(table)
mat coef = coef[.,1..12]
mat stat = (e(N) \ e(r2_a))
mat colnames stat = stat
mat rownames stat = N r2a
mat_capp model : coef stat, miss(.)
mat model = model'

xsvmat model, saving(_assets/RegTrustidOnCovariate.dta) rownames(xvar) names(col)
```

```{r shapeRegTrustidOnCovariate, include=TRUE}
org.indexreg <- read.dta13("_assets/RegTrustidOnCovariate.dta") %>% data.frame()

coef.indexreg <- org.indexreg %>% 
	filter(!is.na(se)) %>% 
	select(xvar, b, se, pvalue) %>% 
	mutate(
		b = case_when(
			pvalue <= 0.01 ~ sprintf("%1.3f***", b),
			pvalue <= 0.05 ~ sprintf("%1.3f**", b),
			pvalue <= 0.1 ~ sprintf("%1.3f*", b),
			TRUE ~ sprintf("%1.3f", b)
		),
		se = sprintf("(%1.3f)", se)
	) %>% 
	select(xvar, b, se) %>% 
	mutate(
		xvar = recode(
			xvar,
			"gender" = "Female",
			"log_pinc_all" = "Logarithm of income",
			"age" = "Age",
			"sqage" = "Squared age/100",
			"2.educ" = "High school graduate",
			"3.educ" = "University graduate",
			"1.political_pref" = "Extreme right wing",
			"2.political_pref" = "Right wing",
			"4.political_pref" = "Left wing",
			"5.political_pref" = "Extreme left wing"
		)
	)

stat.indexreg <- org.indexreg %>% 
	filter(xvar == "stat") %>%
	select(xvar, N) %>% 
	mutate(
		xvar = recode(xvar, "stat" = "N"),
		N = sprintf("%1d", as.integer(N))
	) %>%
	cbind(se = c(""))

tab.indexreg <- rbind(as.matrix(coef.indexreg), as.matrix(stat.indexreg)) %>% 
	data.frame()
```

```{r kableRegTrustidOnCovariate, include=TRUE}
knitr::kable(
    tab.indexreg,
    format = "latex",
    caption = "Regression of Standarized Trust Index (Year = 2018)",
    col.names = c("Variables", "Coefficients", "S.E."),
    row.names = FALSE,
    align = "lcc", 
    booktabs = TRUE, escape = TRUE, linesep = ""
) %>% 
kable_styling()
```

## Subgroup Regressions

To see the heterogenous price elasticity by political trust,
We estimated the baseline regression model (5) (see Table \ref{tab:kableEstimateElasticity}),
using sample grouped by the trust index.

- Lowest: 0 ~ 20\% quantile of trust index
- Lower: 20 ~ 40\% quantile of trust index
- Neutral: 40 ~ 60\% quantile of trust index
- Higher: 60 ~ 80\% quantile of trust index
- Highest: 80 ~ 100\% quantile of trust index

Covariates are the logarithm of income, age, interactions b/w year and education,
interactions b/w year and gender, and living are dummy into covariates.

```{stata EstimateElasticityByTrustGroup, results = "hide", eval = FALSE}
merge m:1 pid using "data\shape\trustid.dta"
drop _merge

forvalues i = 1(1)5 {
	xtreg log_total_g log_price log_pinc_all age i.living_area i.year##i.gender i.year##i.educ ///
		if original5 == `i', fe vce(cluster pid)
	mat coef`i' = r(table)
	mat coef`i' = coef`i'[1..rowsof(coef`i'), 1]
	mat colnames coef`i' = group`i'
	mat stat`i' = (e(N) \ e(r2_a))
	mat colnames stat`i' = group`i'
	mat rownames stat`i' = N r2a
	mat_rapp group`i' : coef`i' stat`i'
}

mat_capp group : group1 group2, miss(.)
mat_capp group : group group3, miss(.)
mat_capp group : group group4, miss(.)
mat_capp group : group group5, miss(.)
mat group = group'

xsvmat group, saving(_assets/EstimateElasticityByTrustGroup.dta) rownames(xvar) names(col)
```

## Results of Subgroup Regressions

We cound **NOT** find the price effect for respondents whose trust is very low.

```{r shapeEstimateElasticityByTrustGroup, include = TRUE}
org.trustreg <- read.dta13("_assets/EstimateElasticityByTrustGroup.dta") %>% data.frame()

coef.trustreg <- org.trustreg %>% 
	filter(!is.na(se)) %>% 
	select(xvar, b, se, pvalue) %>% 
	mutate(
		b = case_when(
			pvalue <= 0.01 ~ sprintf("%1.3f***", b),
			pvalue <= 0.05 ~ sprintf("%1.3f**", b),
			pvalue <= 0.1 ~ sprintf("%1.3f*", b),
			TRUE ~ sprintf("%1.3f", b)
		),
		se = sprintf("(%1.3f)", se)
	) %>% 
	select(xvar, b, se) %>% 
	pivot_longer(-xvar, values_to = "value", names_to = "stat") %>% 
	pivot_wider(values_from = "value", names_from = "xvar") %>% 
	select(-stat) %>% 
	cbind(xvar = c("ln(giving price)", ""), .)

stat.trustreg <- org.trustreg %>% 
	select(xvar, N) %>% 
	mutate(N = sprintf("%1d", as.integer(N))) %>%
	pivot_longer(-xvar, values_to = "value", names_to = "stat") %>% 
	pivot_wider(values_from = "value", names_from = "xvar") %>% 
	select(-stat) %>% 
	cbind(xvar = c("N"), .)

tab.trustreg <- rbind(as.matrix(coef.trustreg), as.matrix(stat.trustreg)) %>% 
	data.frame()
```


```{r kableEstimateElasticityByTrustGroup, include = TRUE}
knitr::kable(
    tab.trustreg,
    format = "latex",
    caption = "Subgroup Regressions",
    col.names = c("", "Lowest", "Lower", "Neutral", "Higher", "Highest"),
    row.names = FALSE,
    align = "lccccc", 
    booktabs = TRUE, escape = TRUE, linesep = ""
) %>% 
kable_styling(font_size = 9)
```


## Regression on Interaction Term

To check whether price elasticity is statistically siginificant different among five trust groups,
we estimated the baseline regression model (5) including interation term between five trust groups and giving price.

\begin{align*}
    \log(\text{Giving}_{ijt}) 
    =& \alpha_i + \beta_1 \log(\text{Price}_{ijt}) \\
    &+ \sum_g \beta_g \log(\text{Price}_{ijt}) \cdot \text{TrustGroup}_{ijg}  \\
    &+ \delta X_{ijt} + \lambda_t + \epsilon_{ijt}.
\end{align*}

- $\text{TrustGroup}_{ijg}$: taking 1 if individual $i$ living in $j$ belongs to the trust group $g$.
- $g \in \{ \text{Lowest}, \text{Lower}, \text{Higher}, \text{Highest} \}$.

```{stata EstimateInteractionByTrustGroup, results = "hide", eval = FALSE}
merge m:1 pid using "data\shape\trustid.dta"
drop _merge

xtreg log_total_g c.log_price##ib3.original5 log_pinc_all age i.living_area i.year##i.gender i.year##i.educ, ///
	fe vce(cluster pid)

mat coef = r(table)
mat coef = coef[.,1..11]
mat stat = (e(N) \ e(r2_a))
mat colnames stat = stat
mat rownames stat = N r2a
mat_capp model : coef stat, miss(.)
mat model = model'

xsvmat model, saving(_assets/EstimateInteractionByTrustGroup.dta) rownames(xvar) names(col)
```

## Regression Result on Interation Term

There is statistically siginificant difference on price elasticity between the lowest group and the nuetral group.

```{r shapeEstimateInteractionByTrustGroup, include=TRUE}
org.intreg <- read.dta13("_assets/EstimateInteractionByTrustGroup.dta") %>% data.frame()

coef.intreg <- org.intreg %>% 
	filter(!is.na(se)) %>% 
	select(xvar, b, se, pvalue) %>% 
	mutate(
		b = case_when(
			pvalue <= 0.01 ~ sprintf("%1.3f***", b),
			pvalue <= 0.05 ~ sprintf("%1.3f**", b),
			pvalue <= 0.1 ~ sprintf("%1.3f*", b),
			TRUE ~ sprintf("%1.3f", b)
		),
		se = sprintf("(%1.3f)", se)
	) %>% 
	select(xvar, b, se) %>% 
	mutate(
		xvar = recode(
			xvar,
			"log_price" = "ln(giving price)",
			"1.original5#c.log_price" = "X Lowest",
			"2.original5#c.log_price" = "X Lower",
			"4.original5#c.log_price" = "X Higher",
			"5.original5#c.log_price" = "X Highest"
		)
	)

stat.intreg <- org.intreg %>% 
	filter(xvar == "stat") %>%
	select(xvar, N) %>% 
	mutate(
		xvar = recode(xvar, "stat" = "N"),
		N = sprintf("%1d", as.integer(N))
	) %>%
	cbind(se = c(""))

tab.intreg <- rbind(as.matrix(coef.intreg), as.matrix(stat.intreg)) %>% 
	data.frame()
```


```{r kableEstimateInteractionByTrustGroup, include=TRUE}
knitr::kable(
    tab.intreg,
    format = "latex",
    caption = "Heterogenous Price Elasticity",
    col.names = c("", "Coefficients", "S.E."),
    row.names = FALSE,
    align = "lcc", 
    booktabs = TRUE, escape = TRUE, linesep = ""
) %>% 
kable_styling() %>% 
add_indent(c(2:5))
```


## Potential Concerns of Heterogenous Price Elasticity

- There is one potential concern that the presidential transition affects both donation behavior and political trust.
    - In May 2017, South Korean president changed from Park Geun-hye to Moon Jae-in. This presidential transition was due to the impeachment charge against Park Geun-hye. People became distrustful of Park Geun-hye due to the shinking of MV Sewol (April 2014).
- To rule out this confounder, we constructed president-specific trust indexs using either in 2015 and 2016 (Park's Trust index) or 
data in 2017 and 2018 (Moon's Trust index).
    - We discussed how to use these indexs later.

## Relationship b/w President-specific Trust Indexs

- We made a scatter plot between Park's trust index and Moon's trust index.
    - Large variation of Moon's trust index among those who have same value of the Park's trust index.
- We tested whether the average individual difference b/w president-specific trust indexs is statistically different from zero.
    - We cannot reject the null hypothesis.


## Scatter Plot b/w President-specific Trust Indexs

```{stata Scatter1Trustid, results = "hide", eval = FALSE}
frame create trustdt
frame trustdt: use "data\shape\trustid.dta", clear

frame trustdt: {
	twoway ///
	(scatter moontrustid parktrustid, color(gs10%50)) ///
	(fpfit moontrustid parktrustid, color(red)), ///
	xtitle("Park's trust index") ytitle("Moon's trust index") ///
	legend(off) ///
	graphregion(fcolor(white))
	
	graph export "_assets/Scatter1Trustid.pdf", replace
}
```

```{r, include=TRUE, out.width="90%", fig.cap = "Scatter Plot between Trust Index under Park Geun-hye and Moon Jae-in"}
knitr::include_graphics(paste(here(), "_assets/Scatter1Trustid.pdf", sep= "/"))
```

## Result of Pair-wise t-test 

```{stata TtestPresidentTrustid, results = "hide", eval = FALSE}
frame create trustdt
frame trustdt: use "data\shape\trustid.dta", clear

frame trustdt: ttest moontrustid == parktrustid

forvalues i = 1(1)2 {
	mat group`i' = (r(mu_`i') \ r(sd_`i'))
	mat colnames group`i' = group`i'
	mat rownames group`i' = mean sd
}

mat diff = (group1[1,1] - group2[1,1] \ r(p))
mat colnames diff = diff
mat rownames diff = mu pval

mat_capp tab : group1 group2
mat_capp tab : tab diff, miss(.)
xsvmat tab, saving(_assets/TtestPresidentTrustid.dta) rownames(xvar) names(col)
```

```{r shapeTtestPresidentTrustid}
org.dfset <- read.dta13("_assets/TtestPresidentTrustid.dta") %>% data.frame()

coef.dfset <- org.dfset %>% 
	select(-diff) %>%
	drop_na() %>% 
	mutate_at(
		vars(-xvar),
		list(~case_when(
				xvar == "mean" ~ sprintf("%1.3f", .),
				xvar == "sd" ~ sprintf("(%1.3f)", .))
		)
	) %>% 
	mutate(xvar = recode(xvar, "mean" = "Average", "sd" = "sd"))

stat.dfset <- org.dfset %>% 
	select(xvar, diff) %>% 
	drop_na() %>% 
	mutate(
		diff = case_when(
			xvar == "mu" ~ sprintf("%1.3f", diff),
			xvar == "pval" ~ sprintf("[%1.3f]", diff)
		),
		xvar = recode(xvar, "mu" = "Average", "pval" = "sd")
	)

tab.dfset <- left_join(coef.dfset, stat.dfset, by = "xvar") %>% 
	mutate(xvar = recode(xvar, "sd" = "", .default = xvar))
```

```{r kableTtestPresidentTrustid, include = TRUE}
knitr::kable(
    tab.dfset,
    format = "latex",
    caption = "Pair-wise T-test",
    col.names = c("", "Moon's trust", "Park's trust", "Difference"),
    row.names = FALSE,
    align = "lccc",
    booktabs = TRUE, escape = TRUE, linesep = ""
) %>% 
kable_styling()
```

## Relationship among Three Trust Indexs

- We made a scatter plot between difference of president-specific trust indexs and the original trust index. 
    - there is large variation of difference of president-specific trust indexs, and there is large variation of the original trust index among those who have similar value of two president-specific trust indexs.
- We regressed the original trust index on difference of president-specific trust indexs. We restrict units whose aboslute value of president-specific trust index difference is less than 2 (Abs < 2), 1 (Abs < 1), and 0.5 (Abs < 0.5). 
    - the positive correlations between difference of president-specific trust indexs and the original one. However, this positive correlation is statistically insignigicant if we use units whose president-specific trust indexs have similar values.
	

## Scatter Plot b/w Difference of Separated Trust Indexs and Original One

```{stata Scatter2Trustid, results = "hide", eval = FALSE}
frame create trustdt
frame trustdt: use "data\shape\trustid.dta", clear

frame trustdt: {
	twoway ///
	(scatter trustid diff, color(gs10%50))  ///
	(fpfit trustid diff, color(red)), ///
	xtitle("Difference b/w president-specific trust index") ///
	ytitle("Trust index") ///
	legend(off)  ///
	graphregion(fcolor(white))

	graph export "_assets/Scatter2Trustid.pdf", replace
}
```

```{r, include=TRUE, fig.cap = "Scatter Plot between Difference of President-specific Trust Indexs and Original One"}
knitr::include_graphics(paste(here(), "_assets/Scatter2Trustid.pdf", sep= "/"))
```


## Result of Regressions on Difference b/w President-specific Trust

```{stata RegTrustidOnDiff2Trustid, results = "hide", eval = FALSE}
frame create trustdt
frame trustdt: use "data\shape\trustid.dta", clear

frame trustdt: reg trustid diff
mat coef1 = r(table)
mat coef1 = coef1[1..9,1]
mat colnames coef1 = model1
mat stat1 = (e(N) \ e(r2_a))
mat colnames stat1 = model1
mat rownames stat1 = N r2a
mat_rapp model1 : coef1 stat1

frame trustdt: reg trustid diff if abs(diff) < 2
mat coef2 = r(table)
mat coef2 = coef2[1..9,1]
mat colnames coef2 = model2
mat stat2 = (e(N) \ e(r2_a))
mat colnames stat2 = model2
mat rownames stat2 = N r2a
mat_rapp model2 : coef2 stat2

frame trustdt: reg trustid diff if abs(diff) < 1
mat coef3 = r(table)
mat coef3 = coef3[1..9,1]
mat colnames coef3 = model3
mat stat3 = (e(N) \ e(r2_a))
mat colnames stat3 = model3
mat rownames stat3 = N r2a
mat_rapp model3 : coef3 stat3

frame trustdt: reg trustid diff if abs(diff) < 0.5
mat coef4 = r(table)
mat coef4 = coef4[1..9,1]
mat colnames coef4 = model4
mat stat4 = (e(N) \ e(r2_a))
mat colnames stat4 = model4
mat rownames stat4 = N r2a
mat_rapp model4 : coef4 stat4

mat_capp tab : model1 model2
mat_capp tab : tab model3 
mat_capp tab : tab model4
mat tab = tab'

xsvmat tab, saving(_assets/RegTrustidOnDiff2Trustid.dta) rownames(xvar) names(col)
```

```{r shapeRegTrustidOnDiff2Trustid}
org.dfset <- read.dta13("_assets/RegTrustidOnDiff2Trustid.dta") %>% data.frame()

coef.dfset <- org.dfset %>% 
	filter(!is.na(se)) %>% 
	select(xvar, b, se, pvalue) %>% 
	mutate(
		b = case_when(
			pvalue <= 0.01 ~ sprintf("%1.3f***", b),
			pvalue <= 0.05 ~ sprintf("%1.3f**", b),
			pvalue <= 0.1 ~ sprintf("%1.3f*", b),
			TRUE ~ sprintf("%1.3f", b)
		),
		se = sprintf("(%1.3f)", se)
	) %>% 
	select(xvar, b, se) %>% 
	pivot_longer(-xvar, values_to = "value", names_to = "stat") %>% 
	pivot_wider(values_from = "value", names_from = "xvar") %>% 
	select(-stat) %>% 
	cbind(xvar = c("Moon's trust - Park's trust", ""), .)

stat.dfset <- org.dfset %>% 
	select(xvar, r2a, N) %>% 
	mutate(N = sprintf("%1d", as.integer(N)), r2a = sprintf("%1.3f", r2a)) %>%
	pivot_longer(-xvar, values_to = "value", names_to = "stat") %>% 
	pivot_wider(values_from = "value", names_from = "xvar") %>% 
	select(-stat) %>% 
	cbind(xvar = c("Adjusted R-sq", "N"), .)

tab.dfset <- rbind(as.matrix(coef.dfset), as.matrix(stat.dfset)) %>% 
	data.frame()
```

```{r kableRegTrustidOnDiff2Trustid, include = TRUE}
knitr::kable(
    tab.dfset,
    format = "latex",
    caption = "Regressions of Trust Index on President-specific Trust Index",
    col.names = c("", "Full", "Abs < 2", "Abs < 1", "Abs < 0.5"),
    row.names = FALSE,
    align = "lcccc",
    booktabs = TRUE, escape = TRUE, linesep = ""
) %>% 
kable_styling(font_size = 9)
```


## Robustness Check of Heterogenous Price Elasticity

1. Using data in 2013 and 2014, we estimated the interaction model again
    - The president was Park Geun-hye in both 2013 and 2014. Thus, we can exclude the effect of presidential transition on donation behavior.
1. Using the park's trust index instead, we estimated the interaction model with data in 2013 and 2014.
    - Since the trust index represents the trust for politicians under the president Park (but scandalous period), we can rule out the effect of presidential transition on both donations and trust.
 
```{stata Robust1EstimateInteractionByTrustGroup, results = "hide", eval = FALSE}
merge m:1 pid using "data\shape\trustid.dta"
drop _merge

foreach v in original5 park5 {
	xtreg log_total_g c.log_price##ib3.`v' log_pinc_all age i.living_area i.year##i.gender i.year##i.educ ///
		if year == 2013|year == 2014, fe vce(cluster pid)
	
	mat coef = r(table)
	mat coef = coef[.,1..11]
	mat stat = (e(N) \ e(r2_a))
	mat colnames stat = stat
	mat rownames stat = N r2a
	mat_capp `v' : coef stat, miss(.)
	mat `v' = `v''
}

xsvmat original5, saving(_assets/RobustEstimateInteractionOriginal.dta) rownames(xvar) names(col)
xsvmat park5, saving(_assets/RobustEstimateInteractionPark.dta) rownames(xvar) names(col)
```

## Result of Robustness Check

```{r shapeRobust1EstimateInteractionByTrustGroup}
org.robintreg <- list(
	read.dta13("_assets/RobustEstimateInteractionOriginal.dta") %>% data.frame(),
	read.dta13("_assets/RobustEstimateInteractionPark.dta") %>% data.frame()
)

coef.robintreg <- org.robintreg %>% 
	purrr::map(function(x)
		x %>% filter(!is.na(se)) %>% 
			select(xvar, b, se, pvalue) %>% 
			mutate(
				b = case_when(
					pvalue <= 0.01 ~ sprintf("%1.3f***", b),
					pvalue <= 0.05 ~ sprintf("%1.3f**", b),
					pvalue <= 0.1 ~ sprintf("%1.3f*", b),
					TRUE ~ sprintf("%1.3f", b)
				),
				se = sprintf("(%1.3f)", se)
			) %>% 
		select(xvar, b, se) %>% 
		pivot_longer(-xvar, values_to = "value", names_to = "stat") %>% 
		mutate(
			xvar = case_when(
				xvar == "log_price" ~ "ln(giving price)",
				str_detect(xvar, "1") ~ "X Lowest Trust",
				str_detect(xvar, "2") ~ "X Lower Trust",
				str_detect(xvar, "4") ~ "X Higher Trust",
				str_detect(xvar, "5") ~ "X Highest Trust"
			)
		)
	) %>% 
	reduce(left_join, by = c("xvar", "stat")) %>% 
	mutate(xvar = case_when(stat == "se" ~ "", TRUE ~ xvar)) %>% 
	select(-stat)

stat.robintreg <- org.robintreg %>% 
	purrr::map(function(x)
		x %>% filter(xvar == "stat") %>% select(N) %>% mutate(N = sprintf("%1d", as.integer(N))) %>% unlist()
	) %>% 
	as_vector()

tab.robintreg <- rbind(as.matrix(coef.robintreg), c("N", stat.robintreg)) %>% data.frame()
```

```{r kableRobust1EstimateInteractionByTrustGroup, include = TRUE}
knitr::kable(
    tab.robintreg,
    format = "latex",
    caption = "Robustness Check of Heterogenous Price Elasticity",
    col.names = c("", "(1)", "(2)"),
    row.names = FALSE,
    align = "lcccc",
    booktabs = TRUE, escape = FALSE, linesep = ""
) %>% 
kable_styling(font_size = 8) %>% 
add_indent(c(3:10)) %>% 
add_header_above(c("Trust index" = 1, "Original" = 1, "Park" = 1)) %>% 
add_header_above(c("Year" = 1, "2013 and 2014" = 2))
```

<!--
## Heterogenity By Political Trust

To capture heterogeneity precisely,
we estimate the following regression equations:

\begin{align*}
    \log(\text{Giving}_{ijt}) = 
    &\alpha_i + \beta_1 \log(\text{Price}_{ijt}) + \beta_2 \log(\text{Price}_{ijt})\cdot\text{Trustid}_{ij} \\
    &+ \delta X_{ijt} + \lambda_t + \epsilon_{ijt}.
\end{align*}

Price elasticity is obtained by $\beta_1 + \beta_2\cdot\text{Trust}_{ij}$.

```{r EstimateHeteroPEstByTrusid, eval=FALSE}

```

## Result of Heterogeneity of Political Trust

The price elasticity is **convex** in the trust index.
Those whose trust index is low and high do not respond to the price incentive.

```{r kableEstimateHeteroPEstByTrusid, include=TRUE, eval=FALSE}
knitr::kable(
    tab.heteroreg,
    format = "latex",
    caption = "Heterogeneity of Political Trust",
    col.names = c("", "(1)", "(2)"),
    row.names = FALSE,
    align = "lcc", 
    booktabs = TRUE, escape = TRUE, linesep = ""
) %>% 
kable_styling() %>% 
add_indent(c(3,5))
```

## Graphical Representation of Heterogeneity Effect

```{r PlotHeteroPElast, include=TRUE, fig.cap="Relationship between Trust Index and Predicted Elasticity", eval=FALSE}

```

-->