---
title: |
  Estimating Effect of Tax Incentives on Charitable Giving Considering Self-Selection of Tax Relief in South Korea
author: 
  - name: Hiroki Kato
    number: 1
  - name: Tsuyoshi Goto
    number: 2
  - name: Yong-Rok Kim
    number: 3
institute:
  - number: 1
    name: Osaka University
  - number: 2
    name: Chiba University
  - number: 3
    name: Kansai University
date: "`r format(Sys.time(), '%Y/%m/%d')`"
bibliography: Rmarkdown/reference.bib
csl: template/csl/elsevier-harvard.csl
aspectratio: 169
graphics: yes
output:
  bookdown::pdf_book:
    base_format: "function(..., number_sections) rmarkdown::beamer_presentation(...)"
    number_sections: false
    latex_engine: xelatex
    keep_tex: true
    toc: false
    slide_level: 2
    template: template/tex/plain.tex
params:
  preview: false
---

```{r knit_command, eval = FALSE, include = FALSE, echo = FALSE}
# If you want to knit draft, please run following command manually!!
rmarkdown::render(
  "slide.Rmd",
  output_file = "slide.pdf",
  output_dir = "paper"
)
```

```{r setup, include = FALSE, echo = FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  echo = FALSE,
  cache = FALSE,
  include = TRUE,
  fig.width = 10, fig.height = 6,
  fig.align = "center", fig.pos = "t",
  out.width = "70%"
)

library(here)
knitr::opts_knit$set(root.dir = here())

options(
  knitr.kable.NA = " ",
  knitr.table.format = "latex",
  modelsummary_stars_note = FALSE
)
```

```{r include = FALSE}
library(xfun)
xfun::pkg_attach2(c(
  "tidyverse", "rlist", "modelsummary", "kableExtra",
  "estimatr", "fixest"
))

lapply(Sys.glob(file.path("script/R/functions", "*.r")), source)
```

## 社会にとって寄付の税インセンティブを与えることは望ましいか？

- 多くの国の税制は、所得控除や税額控除を通して、寄付に金銭的インセンティブを設けている
  - 利点: 公共財の私的供給を促進する
  - 欠点: 税収を減らしてしまう
- 税収の減少分を十分に上回るだけの寄付を増やせれば、税インセンティブは社会的に望ましい
  - 厚生評価の重要なパラメータ: 寄付の（税）価格弾力性
  - この絶対値が1を超えれば、税インセンティブは社会的に望ましい [@Saez2004]
- 韓国の税制改革を用いて、寄付の価格弾力性を推定することを目的とする

## 税インセンティブの自己選択の問題

寄付控除を受けるためには確定申告での寄付申告が必要

- 税インセンティブと申告コストに基づいて、納税者は控除を受けるかどうかを意思決定する
- 申告コストが大きいことを指摘している研究がいくつかある
  - アメリカの個人所得税の確定申告: 申告準備（Record keeping）のコスト > 申告自体（Tax filing）のコスト [@Benzarti2020]
  - イギリスの寄付控除の固定費用: 申告された寄付額の10%に相当 [@Scharf2020]
  - デンマークの寄付控除でも、record keepingのコストを含めた様々なoptimization frictionがある [@Skov2018]
- 韓国においても、寄付控除を受けるためのコストは大きいと考えられる
  - 控除を受けた寄付者の割合は42% (from our data)
  - 控除を受けた寄付者の平均寄付額は174万ウォンである一方、控除を受けていない寄付者の平均寄付額は133万ウォン (from our data)

## 本研究の概要(1)

韓国における2014年の税制改革を用いて、税インセンティブの自己選択を考慮した寄付の価格弾力性を推定する

- 韓国のパネルデータ（National Survey of Tax and Benefit）を使用する
  - サーベイデータの利点 $\to$ 申告された寄付額は実際の寄付額と異なるという測定誤差[@Landais2016; @Skov2018]を回避できる
- 2014年の税制改革（所得控除 $\to$ 税額控除）を税インセンティブの外生変動として利用したDIDで推定する
  - 所得税率に依存したインセンティブ（所得控除）から納税者に一律のインセンティブ（税額控除）に変更
- 申告コストの外生要因として、給与所得者かどうかを用いる
  - 給与所得者はそれ以外よりも申告コストが低いと予想される

## 本研究の概要(2)

結果

1. 寄付の価格弾力性はintensive-marginについて約-1.5であり、extensive-marginについて約-1.7 ~ -2.8であった
    - 寄付申告者に限定した推定 $\to$ -1.2
    - 先行研究と比較して、弾力的な推定値となった
1. これらの推定値を用いると、寄付の税インセンティブを設けることは社会厚生の観点から望ましいことが分かった
1. 申告コストを下げるような政策によって、寄付を増やすことができる

# 韓国の寄付控除制度

## 寄付控除のモデル

\begin{align}
  x_{it} + g_{it} = y_{it} - R_{it}T_t(y_{it}, g_{it}) - (1 - R_{it}) T_t(y_{it})
\end{align}

- $x_{it}$は私的消費財、$g_{it}$は寄付額
- $y_{it}$は課税前所得、$R_{it}$は寄付を申告するかどうかのダミー変数
- $T_t(y_{it})$と$T_t(y_{it}, g_{it})$は寄付申告をしなかったときの課税額と申告したときの課税額
- 寄付の税インセンティブは$s_{it} = \partial T_t(y_{it}, g_{it}) / \partial g_{it}$であり、寄付の相対価格は$1 - s_{it}$

$(g_{it}, y_{it})$を所与として、寄付控除の節税額が申告コスト($K_{it}$)を上回るとき、寄付控除を受ける

\begin{align}
  R_{it} = 1[T_t(y_{it}) - T_t(y_{it}, g_{it}) > K_{it}]
\end{align}

## 2014年の税制改革: 所得控除から税額控除へ

所得控除 (income deduction)

\begin{align}
  T_t(y_{it}, g_{it}) = T_t(y_{it} - g_{it})
\end{align}

- 税インセンティブは$s_{it} = T'_t(y_{it} - g_{it})$
- 高所得であるほど税負担が軽減される（限界税率が高い）ので、低所得より高所得の方が有利な制度

税額控除（tax credit）

\begin{align}
  T_t(y_{it}, g_{it}) = T_t(y_{it}) - m g_{it}
\end{align}

- $m$は税額控除率であり、$m = 0.15$ $\to$ 税インセンティブは$s_{it} = m$
- 2014年の税制改革は税の逆進性を緩和し、税負担の公平性を改善することを目的として、所得に依存しない均一なインセンティブを導入した (Fig. \@ref(fig:SummaryPrice))

## 韓国における寄付申告の手続き

韓国では所得税納税者は寄付に対して税制上の優遇を受けることができる

- 優遇を受けるためには、１年間の寄付の証明書を提出して寄付申告する必要がある
  - 給与所得者と非給与所得者で手続きが大きく異なる
- 給与所得者
  - 所得税を源泉徴収で納税し、寄付申告は会社で行う
  - 給与所得者は証明書の提出は随時行うことができる
  - 控除制度の正しい理解や書類作成の必要は特にない
- 非給与所得者
  - 所得納税を確定申告で行い、寄付申告は確定申告時に国税庁で行う
  - 確定申告は翌年の５月に実施
  - 確定申告時まで証明書を保存しておく必要がある $\to$ 寄付証明書の発行をめぐり、寄付団体に５月頃問い合わせが殺到
  - 確定申告時には寄付金控除を受けるための申請書類を作成する必要がある
- 給与所得者のほうが寄付の申告コスト($K_{it}$)が低いと考えられる (Fig. \@ref(fig:SummaryReliefbyEarner))

# データ

```{r}
knitr::spin_child("script/1-summary.R")
```

# 寄付の価格弾力性の推定

```{r}
knitr::spin_child("script/2-stage1.R")
```

```{r}
knitr::spin_child("script/3-elasticity1.R")
```

# 社会厚生への含意

## モデルの設定

@Scharf2020 にならい、個人の効用関数を特定化し、以下の最適化問題を考える

\begin{align}
  \max_{x_i,g_i,R_i}&U(x_i,g_i,G)= x_i - R_iK +\theta u(g_i) + V(G)\notag\\
  \text{s.t. }&x_i + g_i = R_i(y-T(y, g_i)) + (1-R_i)(y-T(y)),\notag\\
  &\text{ and }G=g_i+G_{-i}\notag,
\end{align}

ただし$\theta\in[\underline{\theta},\bar{\theta}$]は寄付選好で密度$f(\cdot)$に従う。 

- $G$は政府供給も含めた社会の寄付総量。
- $G_{-i}$は社会の寄付総量から$i$の寄付を除いたもの。
- 簡単化のため、所得税は線形で税率$\tau$とする。
- 社会の人口は1と基準化

## 最適化

- 最適化問題の結果、寄付者のうち寄付申告をする人としない人の(寄付に関する)間接効用関数はそれぞれ以下のようになる。

\begin{align}
  \nu(p;\theta)&=\theta_i u(g(p;\theta))-pg(p;\theta)\notag\\
  \nu(1;\theta)&=\theta_i u(g(1;\theta))-g(1;\theta)\notag.
\end{align}

- $(1-\tau)y$、$K$、$V(G)$は各人で共通なので、とりあえず捨象している。(申告コスト$K$について$K_H>K_L$というような差があっても以下の議論はほぼ変わらない。)

## 社会厚生関数の設定

- 寄付選好$\theta$と寄付価格$p$の大きさによって社会には以下の3種類の人が存在。
	  1. 非寄付者: $\theta\le \theta_0$
		2. 寄付者かつ非寄付申告者: $\theta\in(\theta_0,\theta(p)]$ $\to$ 彼らの寄付総額を$g^0(p)\equiv\int_{\theta_0}^{\theta(p)}g(1;\theta)f(\theta)d\theta$とする。
    3. 寄付者かつ寄付申告者: $\theta>\theta(p)$ $\to$ 彼らの寄付総額を$g^1(p)\equiv\int_{\theta(q)}^{\bar{\theta}}g(p;\theta)f(\theta)d\theta$とする。
- 社会厚生は以下のようになる。
\begin{align}
  W=V(G)&+\int_{\theta(p)}^{\bar{\theta}}(\nu(p;\theta)-K)f(\theta)d\theta\notag\\
  &+\int_{\theta_0}^{\theta(p)}\nu(1;\theta)f(\theta)d\theta+\lambda[ty-(1-p)g^1(p)-G_g]\notag
\end{align}

ただし$\lambda$は公的資金の限界費用(MCPF)を表す。
- 政府はMCPFと公共財の限界効用が等しくなるように公共財を供給し$\lambda=V'$となる[@Saez2004]。


## 寄付価格の社会厚生に対する効果(1)

- 寄付価格$p$を変化させたときの社会厚生$W$の変化を考えると

\begin{align}
  dW 
  =(g_p^0+g_p^1)V'dp+\int_{\theta(p)}^{\bar{\theta}}\underbrace{\nu_p(p;\theta)}_{=-g(p;\theta)}f(\theta)d\theta dp+\lambda[g^1-(1-p)g^1_p]dp\notag
\end{align}

なので、$\lambda=V'$より

\begin{align}
  \frac{dW}{dp} =\lambda (g_p^0+g_p^1)+(\lambda-1)g^1-\lambda(1-p)g_p^1\notag
\end{align}

## 寄付価格の社会厚生に対する効果(2)
		
- 寄付価格を下げたときに社会厚生が上がる$\frac{dW}{dp}<0$の条件は

\begin{align}
  \epsilon\equiv -\frac{pg_p^1}{g^1}>\frac{\lambda-1}{\lambda}+\frac{g_p^0}{g^1}\notag.
\end{align}

  - サブサンプル分析より$\epsilon$は1.304 $\sim$ 1.603
	- MCPFは$\lambda\in[1,2]$だと仮定し、$\frac{\lambda-1}{\lambda}\in[0,\frac12]$となる。
	- 2017年データの$g^1$と$g_p^0$の推定値を使うと、$\frac{g_p^0}{g^1}$は0.279$\sim$0.471
- $\frac{dW}{dp}<0$がいえ、寄付価格低下で社会厚生が上がると示唆。

## 申告コストの社会厚生に対する効果

$W$を$K$で微分すると

\begin{align}
  \frac{dW}{dK}=&[F(\theta(p))-1]+\lambda(1-p)g(p:\theta(p))\underbrace{f(\theta(p))}_{\simeq0}\frac{\partial \theta(p)}{\partial K}\notag\\
  =&F(\theta(p))-1<0\notag
\end{align}

- $F(\theta(p))$は寄付申告しない人の割合を表すことから、$F(\theta(p))-1$は寄付申告者の割合の負値であるといえる。
- 社会厚生へは寄付申告者の私的財消費が$dK$だけ増える効果が見られる。

## 社会厚生への含意

申告コスト$K$と寄付価格$p$を下げた場合の厚生への効果は

\begin{align}
  \frac{dW}{dK}=&F(\theta(p))-1<0\notag\\
  \frac{dW}{dp}=&\lambda g_p^0+(\lambda-1)g^1+\lambda pg_p^1\notag
\end{align}

2017年のデータを使うとそれぞれ

- $\frac{dW}{dK}=F(\theta(p))-1=-0.107$
- MCPFについて、$\lambda\in[1,2]$とすると、$\frac{dW}{dp}\in[-237.9, -169.9]$
- 申告コストよりも寄付価格を下げた方が厚生増大は大きい。
  - 申告コストの微小な低下は寄付申告者(+$\alpha$)の所得にのみ影響し、寄付を増やす効果はあまりない。
  - 寄付価格の微小な低下は主に寄付申告者の寄付への価格効果をもたらし、寄付による効用と寄付(=公共財)の正の外部性を通じた厚生増大の効果がある。

# (Primitive Result) Marginal Treatment Effect

```{r}
knitr::spin_child("script/4-mte.R")
```

# Appendix

## 所得税率の変遷

```{r TaxRate}
tab <- data.frame(
    inc = c(
        "(A) ~ 1200", "(B) 1200 ~ 4600", "(C) 4600 ~ 8800", "(D) 8800 ~ 15000",
        "(E) 15000 ~ 30000", "(F) 30000 ~ 50000", "(G) 50000 ~"),
    Y08 = c("8%", "17%", "26%", rep("35%", 4)),
    Y09 = c("6%", "16%", "25%", rep("35%", 4)),
    Y1011 = c("6%", "15%", "24%", rep("35%", 4)),
    Y1213 = c("6%", "15%", "24%", rep("35%", 2), rep("38%", 2)),
    Y1416 = c("6%", "15%", "24%", "35%", rep("38%", 3)),
    Y17 = c("6%", "15%", "24%", rep("35%", 2), "38%", "40%"),
    Y18 = c("6%", "15%", "24%", "35%", "38%", "40%", "42%")
)

knitr::kable(
    tab,
    caption = "Marginal Income Tax Rate",
    col.names = c(
      "Income/Year", "2008", "2009", "2010 ~ 2011",
      "2012 ~ 2013", "2014 ~ 2016", "2017", "2018"
    ),
    row.names = FALSE,
    align = "lccccccc",
    booktabs = TRUE, escape = TRUE, linesep = ""
) %>%
kable_styling(font_size = 9) %>%
collapse_rows(columns = 2:8, valign = "middle", latex_hline = "full") %>%
footnote(general_title = "", general = "Notes: Marginal income tax rates applied from 2008 to 2018 are summarized. The income level is shown in terms of 10,000 KRW, which is approximately 10 United States dollars (USD) at an exchange rate of 1,000 KRW to one USD.", threeparttable = TRUE, escape = FALSE)
```

## Distribution of Donations Conditional on Donors

```{r SummaryGivingIntensiveDist, ref.label = "SummaryGivingIntensiveDist", fig.cap = "Distribution of Charitable Giving among Those Who Donated", out.extra = ""}
```

## Share of Application Conditional on Donors by Wage Earners

```{r SummaryReliefbyEarner2, ref.label = "SummaryReliefbyEarner2", fig.cap = "Share of Tax Relief by Wage Earners Conditional on Donors. Notes: A solid line is the share of applying for tax relief among wage eaners. A dashed line is the share of applying for tax relief other than wage earners.", out.extra = ""}
```

## Intensive-Margin Tax-Price Elasticity w/o Announcement Effect

```{r WoAnnoucementIntensive}
```

## Extensive-Margin Tax-Price Elasticity w/o Announcement Effect

```{r WoAnnouncementExtensive}
```

## Intensive-Margin Tax-Price Elasticity (Last-Unit Price)

```{r LastIntensive}
```

## Extensive-Margin Tax-Price Elasticity (Last-Unit Price)

```{r LastExtensive}
```

```{r}
knitr::spin_child("script/4-elasticity2.R")
```

# References {-}
