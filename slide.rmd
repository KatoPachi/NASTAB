---
title: |
  Estimating Effect of Tax Incentives on Charitable Giving Considering Self-Selection of Tax Relief in South Korea
author: 
  - name: Hiroki Kato
    number: 1
  - name: Tsuyoshi Goto
    number: 2
  - name: Yong-Rok Kim
    number: 3
institute:
  - number: 1
    name: Osaka University
  - number: 2
    name: Chiba University
  - number: 3
    name: Kansai University
date: "`r format(Sys.time(), '%Y/%m/%d')`"
bibliography: Rmarkdown/ref_main.bib
csl: template/csl/elsevier-harvard.csl
aspectratio: 169
graphics: yes
output:
  bookdown::pdf_book:
    base_format: "function(..., number_sections) rmarkdown::beamer_presentation(...)"
    number_sections: false
    latex_engine: xelatex
    keep_tex: true
    toc: false
    slide_level: 2
    template: template/tex/plain.tex
params:
  preview: false
---

```{r knit_command, eval = FALSE, include = FALSE, echo = FALSE}
# If you want to knit draft, please run following command manually!!
rmarkdown::render(
  "slide.Rmd",
  output_file = "slide.pdf",
  output_dir = "paper"
)
```

```{r setup, include = FALSE, echo = FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  echo = FALSE,
  cache = FALSE,
  include = TRUE,
  fig.width = 10, fig.height = 6,
  fig.align = "center", fig.pos = "t"
)

library(here)
knitr::opts_knit$set(root.dir = here())

options(
  knitr.kable.NA = " ",
  knitr.table.format = "latex",
  modelsummary_stars_note = FALSE
)
```

```{r include = FALSE}
library(xfun)
xfun::pkg_attach2(c(
  "tidyverse", "rlist", "modelsummary", "kableExtra",
  "estimatr", "fixest"
))

lapply(Sys.glob(file.path("script/R/functions", "*.r")), source)
```

## お詫び

私の準備不足のために、
本スライドと他のスライド（12/5に行われた公共選択学会で共著者の後藤さんが使用された日本語スライド）
を併用してご報告させていただきます。

皆さまにご不便をおかけして申し訳ありません<(_ _)>


## Introduction

- In many countries, tax relief for charitable giving are implemented.
- The elasticity of giving tax relief is known as a key parameter to evaluate the welfare implication [@Saez2004].
  - Intuitively, if the elasticity is more than 1 in absolute value, \$1 of tax relief make more than \$1 of charitable giving.
- Many papers investigate the elasticity based on tax return data [@Almunia2020; @Auten2002].

## Introduction

- However, the tax return data record only the declared charitable giving.
	- First issue: **Actual donations is different from declared donations.** [@Fack2016; @Gillitzer2018]
  - We use panel survey data in South Korea to deal with this issue.
- Tax payers decide the amount of donation and whether to declare tax relief based on the size of tax incentive and declaration cost.
  - Second issue: Neglect of this declaration cost may bias the estimations of elasticity.
  - We use instrumental variable (IV) and control function approach for this issue.
- Based on DID as an identification strategy, we investigate the giving price elasticity of South Korea.

## Introduction

Result

1. Baseline results show that the giving price elasticity is less than -1.4 in terms of intensive margins and less than -1.7 in terms of extensive margins in Korea.
2. The estimated giving price elasticity for those who declare charitable giving is around -1.2 -1.6.
    - These estimates are more elastic than the estimates in the extant research, many of which show around -1.
3. By reducing application cost, we can increase charitable giving. 
4. Given our estimates, increasing the subsidy on charitable giving will be desirable in Korea.

# Conceptual Frameworks

## Optimization Problem

Following @Almunia2020,
consider allocation problem between private consumption ($x_{it}$) and charitable giving ($g_{it}$)

\begin{align}
  \max_{x_{it}, g_{it}, R_{it}} &U(x_{it}, g_{it}, G_t)
  = u_i(x_{it}, g_{it}, G_t) - R_{it}K_{it}, \\
  \text{s.t.}\:\:
  &x_{it} + g_{it}
  = y_{it} - R_{it} T_{it}(y_{it}, g_{it}) - (1 - R_{it}) T_{it}(y_{it}), \\
  &G_t = g_{it} + G_{-it},
\end{align}

where $y_{it}$ is pre-tax total income, $R_{it}$ is a dummy of declaration of tax relief and $T_{it}(y_{it})$ and $T_{it}(y_{it}, g_{it})$ are respectively the amount of tax when $i$ does not declare tax relief and when $i$ declares tax relief in year $t$. $G_{-it}$ is public goods supplied by others.

## Remarks on Optimization Problem

We assume

- No saving
- $G_{-it}$ is large enough to $\frac{\partial u_i}{\partial G}(x, g, G) \approx 0$

Given $R_{it}$, optimal level of donations sloves

\begin{align}
  \max_{g_{it}} u_i(
    y_{it} - R_{it} T_{it}(y_{it}, g_{it}) - (1 - R_{it}) T_{it}(y_{it}) - g_{it}, g_{it}, g_{it} + G_{-it}
  ).
\end{align}

- We can ignore application cost $K_{it}$ when solving optimal giving level because the application cost does not depend on $g_{it}$

## First-Order Condition

\begin{align}
  - \frac{\partial u_i}{\partial x_{it}}
  \left( R_{it} \frac{\partial T_{it}}{\partial g_{it}}(y_{it}, g_{it}) + 1 \right)
  + \frac{\partial u_i}{\partial g_{it}} = 0
\end{align}

- $\partial T_{it} / \partial g_{it} < 0$ is tax incentive of charitable giving.
  - Let $s_{it} \equiv |\partial T_{it} / \partial g_{it}|$ be size of tax incentive.
  - Relative giving price is $1 - s_{it}$
  - As we explain later, there is *within* variation of $s_{it}$ due to tax reform.

Let $g_i(1 - R_{it} s_{it}, y_{it})$ be a demand function of charitable giving.

- Define $g_i(1 - s_{it}, y_{it})$ and $g_i(1, y_{it})$ to be the optimal levels of donations (potential outcomes) for choices $R_{it} = 1, 0$ respectively.

## Self-Selection of Tax Relief

We can write indirect utility (without application cost) as

\begin{align}
  &v_i(1 - s_{it}, y_{it}, G_{-it}) - K_{it},  \\
  &v_i(1, y_{it}, G_{-it}).
\end{align}

Thus, individual $i$ applies for tax relief in year $t$,
that is, $R_{it} = 1$ iff

\begin{align}
  \Delta v_{it} \equiv
  v_i(1 - s_{it}, y_{it}, G_{-it}) - v_i(1, y_{it}, G_{-it})
  \ge K_{it}.
\end{align}


# Identification Strategy
## Outcome Equation

We assume the demand function $g_i(y_{it}, 1 - R_{it} s_{it})$ can be written as the following log-log demand function with two-way FEs:

\begin{align}
  \ln g_{it} = \theta_i + \gamma \ln(1 - R_{it}s_{it}) + \beta X'_{it} + \iota_t + u_{it}.
\end{align}

- $\theta_i$ and $\iota_t$ are individual and time FE, respectively.
- $X_{it}$ includes pre-tax income ($y_{it}$) and others.
- If $R_{it} = 1$, then the logged price of giving is $\ln(1 - s_{it})$; otherwise, $\ln 1 = 0$.

Our parameter of interest is $\gamma$, which represents the price elasticity of charitable giving.

## 2014 Tax Reform in South Korea

Our major *within* variation of tax incentive ($s_{it}$) comes from the 2014 tax reform.

- Before 2014, tax deduction (所得控除) was used for tax relief on charitable giving.
    - the giving price depended on income level.
-	After 2014, tax credit (税額控除) started to be used for tax relief on charitable giving.
    - The tax credit rate was determined as 15\%.
    - Giving price is 0.85, irrespective of income level.

## 2014 Tax Reform in South Korea

**Tax deduction system (until 2013)**

\begin{align}
  T_{it}(y_{it}, g_{it}) = T_{it}(y_{it} - g_{it})
\end{align}

- In 2012 and 2013, the marginal tax rate was the same, though it was different from ones before 2011.
- Tax incentive is $s_{it} = T'(y_{it} - g_{it})$

**Tax credit system (from 2014)**

\begin{align}
  T_{it}(y_{it}, g_{it}) = T_{it}(y_{it}) - m g_{it}
\end{align}

- $m$ is tax credit rate and is $m = 0.15$
- Tax incentive is $s_{it} = m$

## Source of Endogeneity

- Giving price is endogenous to the amount of giving before 2014
  - $s_t(y_{it}, g_{it}) = T'(y_{it} - g_{it})$ if $t < 2014$. $s_t(y_{it}, g_{it}) = 0.15$ if $t \ge 2014$.
  - $1 - R_{it} s_t(y_{it}, g_{it})$ is called as the last-price $s^f_t(y_{it}) = s_t(y_{it}, 0)$
  - Instead, we use the first-price $1 - R_{it} s^f_t(y_{it})$ where 
- If the declaration cost is ignored, the estimation should be biased.
	- The giving price depends not only on marginal tax rate and tax credit rate, but also on the declaration behavior.
  - As far as we know, only @Almunia2020 deal with this problem, though they used tax return data.
  - We use the first-price of giving if taxpayers had applied for tax relief $1 - s^f_t(y_{it})$.

## First-Stage Equation

\begin{align}
  \ln(1 - R_{it}s^f_{it})
  = \theta_{1i} + \delta_1 \ln(1 - s^f_{it}) + \delta_2 X'_{it} + \iota_{1i} + v_{it}
\end{align}

Validity of instrument

- Since $\ln(1 - R_{it} s^f_{it}) = R_{it} \times \ln(1 - s^f_{it})$, we include the effect of first price on charitable giving in outcome equation.
- Thus, instument does not affect outcomes conditional on covariates (Exclusion restriction)
- Increasing the first-price decreases the benefit of tax relief ($\Delta v_{it}$). There is no taxpayers who apply for tax relief by an increase of price (Monotonicity).

# Data

```{r}
knitr::spin_child("script/R/1-summary.R")
```

# Estimating Conventional Price Elasticities

```{r}
knitr::spin_child("script/R/2-elasticity.R")
```

# Control Function Approach

```{r}
knitr::spin_child("script/R/3-cf_approach.R")
```

# Welfare Implication

```{r eval = FALSE}
knitr::spin_child("script/R/4-welfare.R")
```

# Conclusion

# References {-}
